
```{r}
library(survey)
library(readxl)
library(dplyr)
library(stringr)
library(tidyverse)

```


#Task1

```{r}

df <- read_excel("sample_school_student_list.xls", col_names = FALSE)

#Clean the data frame: extract teacher, grade, and student names
df_clean <- df %>%
  rename(col1 = ...1, col2 = ...2, col3 = ...3) %>%
  fill(col1, .direction = "down") %>%
  filter(!is.na(col3)) %>%
  mutate(Teacher = str_remove(col1, "Teacher: "),
         Grade = col1,
         Surname = col2,
         GivenName = col3) %>%
  filter(!is.na(GivenName)) %>%
  mutate(Teacher = na_if(Teacher, Grade),
         Grade = as.integer(Grade)) %>%
  fill(Teacher, .direction = "down") %>%
  select(Grade, Teacher, Surname, GivenName)

#Check the number of students under each teacher
df_counts <- df_clean %>%
  group_by(Teacher) %>%
  summarise(n = n()) %>%
  arrange(desc(n))

print(df_counts)

#Split each teacherâ€™s students into two sampling error computation units (SECUs)
set.seed(123)
df_clean <- df_clean %>%
  group_by(Teacher) %>%
  mutate(SECU = sample(rep(1:9, length.out = n()))) %>%
  ungroup()

# Check sample size of each SECU
secus <- df_clean %>%
  group_by(Teacher, SECU) %>%
  summarise(sample_size = n())

print(secus)
```
